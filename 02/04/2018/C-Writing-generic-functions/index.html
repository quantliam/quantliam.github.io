<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="C++,Notes," />










<meta name="description" content="Generic function - an exampleGeneric functions are functions written in a way that is independent of any particular type. When we use a generic program, we supply the type(s) or value(s) on which that">
<meta name="keywords" content="C++,Notes">
<meta property="og:type" content="article">
<meta property="og:title" content="C++ - Writing generic functions">
<meta property="og:url" content="http://www.quanttour.com/02/04/2018/C-Writing-generic-functions/index.html">
<meta property="og:site_name" content="Liam&#39;s Blog">
<meta property="og:description" content="Generic function - an exampleGeneric functions are functions written in a way that is independent of any particular type. When we use a generic program, we supply the type(s) or value(s) on which that">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2018-04-02T15:10:35.980Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="C++ - Writing generic functions">
<meta name="twitter:description" content="Generic function - an exampleGeneric functions are functions written in a way that is independent of any particular type. When we use a generic program, we supply the type(s) or value(s) on which that">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://www.quanttour.com/02/04/2018/C-Writing-generic-functions/"/>





  <title>C++ - Writing generic functions | Liam's Blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Liam's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">If history repeats itself, and the unexpected always happens, how incapable must Man be of learning from experience?—George Bernard Shaw.</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.quanttour.com/02/04/2018/C-Writing-generic-functions/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Liam">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Liam's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">C++ - Writing generic functions</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-02T14:41:58+08:00">
                02-04-2018
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Programming/" itemprop="url" rel="index">
                    <span itemprop="name">Programming</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  967
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  6
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="Generic-function-an-example"><a href="#Generic-function-an-example" class="headerlink" title="Generic function - an example"></a>Generic function - an example</h1><p><em>Generic functions are functions written in a way that is independent of any particular type. When we use a generic program, we supply the type(s) or value(s) on which that instance of the program will operate</em>(Lippman etc. 2012). In C++, we can create generic functions by defining <strong>template function</strong>s, allowing writing a single definition for a family of functions or types that behave similarly but have different types of paratmters. The only difference can be summarized as parameters, namely, <strong>template parameters</strong>. Take the median function as an example, its template can be defined as follows.<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">T</span> <span class="title">median</span>(<span class="title">vector</span>&lt;T&gt; <span class="title">v</span>)</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">typedef</span> <span class="keyword">typename</span> <span class="built_in">vector</span>&lt;T&gt;::size_type vec_sz;</span><br><span class="line"></span><br><span class="line">    vec_sz size = v.size();</span><br><span class="line">    <span class="keyword">if</span>(size == <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">throw</span> domain_error(<span class="string">"median of an empty vector"</span>);</span><br><span class="line"></span><br><span class="line">    sort(v.begin(), v.end());</span><br><span class="line"></span><br><span class="line">    vec_sz mid = size/<span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> size % <span class="number">2</span> ? (v[mid] + v[mid - <span class="number">1</span>])/<span class="number">2</span> : v[mid];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>From the definition, we observe</p>
<ol>
<li>A <strong>template</strong> starts with keyword <strong>template</strong> followed by <strong>type parameter(s)</strong> enclosed by a pair of angle brackets. </li>
<li><strong>type parameter(s)</strong> define the names that can be used within the scope of the function. They refer to types, not variables. In other words, the types of template parameters can be regarded as variables that have types specified by <strong>type parameters(s)</strong>. </li>
<li><strong>type parameter(s)</strong> are specified following the keyword <strong>class</strong> or <strong>typename</strong>. </li>
<li>the <strong>template</strong> tells implementation that <strong>vector<t>::size_type</t></strong> is the name of a type by adding keyword <strong>typename</strong> before. </li>
</ol>
<p>When we call <strong>median</strong> and pass a <strong>template argument</strong> vector<int>, the implementation will create and compile an instance of the function as if the function <strong>median(vector<int>)</int></strong>. This is so called <strong>template instantiation</strong>. But how is the template compiled?</int></p>
<p>When the compiler encounters the definition of a template, it doesn’t generate code. It generates only when the template is instantiated. Remembering that when we call a function, we need to supply only its declaration. But if we want to call the template, we need to supply not only its declaration but also its definition in order to instantiate it. Therefore, the header file of a template generally includes the source file also via a <strong>#include</strong> or directly. I found an article <a href="https://www.codeproject.com/Articles/3515/How-To-Organize-Template-Source-Code" target="_blank" rel="noopener">How To Organize Template Source Code</a>, where gives detailed explinations on how to organize template source code and three solutions.</p>
<p>Due to the feature of generating code during instantiation, compilation errors may occur during three stages:</p>
<ol>
<li>the first stage is when we compile the template itself. But the compiler can only detect some syntax errors like forgetting a semicolon, misspelling a variable name etc..</li>
<li>the second stage is when we use a template, before it is instantiated. The compiler typically will check that whether the number of the arguments is appropriate, whether two arguments that are supposed to have the same type do so.</li>
<li>the type-related errors mostly occurs during the third stage when the template is instantiated. Though implementations manage instantiation on their own ways, the type-related errors may be reported at link time due to that implementations assume the type is possibly defined in other unit and hence leave it to linker to resolve. </li>
</ol>
<p>In fact, we have applied many templates in previous programs, such as <strong>vector</strong> and <strong>list</strong>, and all standard library algorithms. </p>
<h1 id="Algorithms-and-iterators"><a href="#Algorithms-and-iterators" class="headerlink" title="Algorithms and iterators"></a>Algorithms and iterators</h1><p>As shown in above example, the template is type independent. However, it is also clear that the function to instantiate requires its argument supporting all operations included in the function. In above case, the types stored in the vectors that are passed to the median function must support addition and division. </p>
<p>The standard algorithms are not limited by the type of containers and obviously are data-structure independent function templates. It is known that the parameters taken by algorithms includes iterators and others. This implies that iterators to pass should support certain operations used inside of the algorithms. But we also know that some containers may support operations that others do not. For example, <strong>vector</strong> support random access elements via iterators while <strong>list</strong> doesn’t. Therefore, it is important  to restrict the right of iterators depending on operations that an algorithm include and operations different containers support. For this reason, the library defines five <strong>iterator categories</strong> with specifying the collection of iterator operations for each category. By doing so, we know exactly what effect of an algorithm can have on an container and which container can use which algorithms. </p>
<h2 id="Sequential-read-only-access"><a href="#Sequential-read-only-access" class="headerlink" title="Sequential read-only access"></a>Sequential read-only access</h2><p>Some algorithms only require iterators that can access elements sequentially. For example, the <strong>find</strong> algorithm:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">In</span>, <span class="title">class</span> <span class="title">X</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">In</span> <span class="title">find</span>(<span class="title">In</span> <span class="title">beg</span>, <span class="title">In</span> <span class="title">end</span>, <span class="title">const</span> <span class="title">X</span> &amp;<span class="title">x</span>)</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">while</span> (begin != end &amp;&amp; *begin != x)</span><br><span class="line">        ++begin;</span><br><span class="line">    <span class="keyword">return</span> begin;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>The iterators of type <strong>In</strong> access elements sequentially via<br>operations <strong><em>*</em></strong>, <strong>++</strong>. Also, they can be compared using <strong>!=</strong>. Alternatively,</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">In</span>, <span class="title">class</span> <span class="title">X</span>&gt;</span></span><br><span class="line"><span class="class"><span class="title">In</span> <span class="title">find</span>(<span class="title">In</span> <span class="title">begin</span>, <span class="title">In</span> <span class="title">end</span>, <span class="title">const</span> <span class="title">X</span> &amp;<span class="title">x</span>)</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">if</span> (begin == end || *begin == x)</span><br><span class="line">        <span class="keyword">return</span> begin;</span><br><span class="line">    begin++;</span><br><span class="line">    <span class="keyword">return</span> find(begin, end, x);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>This version of <strong>find</strong> uses another strategy, recursively calling itself. We have observed that the iterators may also need to support operations <strong>++</strong>(postfix) and <strong>==</strong>. </p>
<p>Furthermore, the iterators ought to support member access via <strong>-&gt;</strong>, e.g. it-&gt;first. It has the same effect as <strong>(*it).first</strong>. </p>
<p>In summary, iterators that offers sequential read-only access to elements of a container should supports <strong>++</strong>(both prefix and postfix), <strong>==</strong> and <strong>!=</strong>, <strong><em>*</em></strong> and <strong>-&gt;</strong>. Such iterators are named as <strong>input iterators</strong>.</p>
<h2 id="Sequential-write-only-access"><a href="#Sequential-write-only-access" class="headerlink" title="Sequential write-only access"></a>Sequential write-only access</h2><p>Some algorithms may require write elements of a sequence via iterators, for example<br>```c++<br>template <class in,="" class="" out=""><br>Out copy(In begin, In end, Out dest)<br>{<br>    while(begin != end)<br>        <em>dest++ == </em>begin++;<br>    return dest;<br>}</class></p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/C/" rel="tag"># C++</a>
          
            <a href="/tags/Notes/" rel="tag"># Notes</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/31/03/2018/Accelerated-C-Solutions-to-Exercises-Chapter-7-Part-2/" rel="next" title="Accelerated C++ Solutions to Exercises(Chapter 7 Part 2)">
                <i class="fa fa-chevron-left"></i> Accelerated C++ Solutions to Exercises(Chapter 7 Part 2)
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Liam</p>
              <p class="site-description motion-element" itemprop="description">Stochastic Modelling Notes; Programming Notes</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">32</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">1</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/quantliam" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:yanshijiutu@gmail.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Generic-function-an-example"><span class="nav-number">1.</span> <span class="nav-text">Generic function - an example</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Algorithms-and-iterators"><span class="nav-number">2.</span> <span class="nav-text">Algorithms and iterators</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Sequential-read-only-access"><span class="nav-number">2.1.</span> <span class="nav-text">Sequential read-only access</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Sequential-write-only-access"><span class="nav-number">2.2.</span> <span class="nav-text">Sequential write-only access</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Liam</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">73.7k</span>
  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
