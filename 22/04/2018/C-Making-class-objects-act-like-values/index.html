<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="C++,Notes," />










<meta name="description" content="As last chapter introduces, we can control what happens when objects are created, copied, assigned, and destroyed by defining special members. Now we intend to make class objects act like objects of b">
<meta name="keywords" content="C++,Notes">
<meta property="og:type" content="article">
<meta property="og:title" content="C++ - Making class objects act like values">
<meta property="og:url" content="http://www.quanttour.com/22/04/2018/C-Making-class-objects-act-like-values/index.html">
<meta property="og:site_name" content="Liam&#39;s Blog">
<meta property="og:description" content="As last chapter introduces, we can control what happens when objects are created, copied, assigned, and destroyed by defining special members. Now we intend to make class objects act like objects of b">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2018-04-23T15:24:39.522Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="C++ - Making class objects act like values">
<meta name="twitter:description" content="As last chapter introduces, we can control what happens when objects are created, copied, assigned, and destroyed by defining special members. Now we intend to make class objects act like objects of b">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://www.quanttour.com/22/04/2018/C-Making-class-objects-act-like-values/"/>





  <title>C++ - Making class objects act like values | Liam's Blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Liam's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">If history repeats itself, and the unexpected always happens, how incapable must Man be of learning from experience?—George Bernard Shaw.</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.quanttour.com/22/04/2018/C-Making-class-objects-act-like-values/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Liam">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Liam's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">C++ - Making class objects act like values</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-22T09:09:27+08:00">
                22-04-2018
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Programming/" itemprop="url" rel="index">
                    <span itemprop="name">Programming</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  3,609
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  23
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>As last chapter introduces, we can control what happens when objects are created, copied, assigned, and destroyed by defining special members. Now we intend to make class objects act like objects of built-in types through controlling more operations such as type conversion. A typical example is that the standard library class <strong>string</strong> provides rich set of operators and supports automatic conversions. Following the standard <strong>string</strong>, we’ll write our own <strong>Str</strong> class. </p>
<h1 id="A-simple-string-class"><a href="#A-simple-string-class" class="headerlink" title="A simple string class"></a>A simple string class</h1><p>Analogous to the <strong>Vec</strong> class built in last chapter, we could write our <strong>Str</strong> based on dynamiclly allocated array. But it is also known that the standard <strong>string</strong> share many operations with the standard <strong>vector</strong> while the major difference is that a <strong>string</strong> is a container that only contains <strong>char</strong> elements. Therefore, we can design <strong>Str</strong> based on <strong>Vec</strong> rather than the lower level data structure.<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Str</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">typedef</span> Vec&lt;<span class="keyword">char</span>&gt;::size_type size_type;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// default constructor; create an empty Str</span></span><br><span class="line">    Str() &#123; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// create a Str containing n copies of c</span></span><br><span class="line">    Str(size_type n, <span class="keyword">char</span> c): data(n, c) &#123; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// create a Str from a null-terminated array of char</span></span><br><span class="line">    Str(<span class="keyword">const</span> <span class="keyword">char</span>* cp)&#123;</span><br><span class="line">        <span class="built_in">std</span>::copy(cp, cp + <span class="built_in">std</span>::<span class="built_in">strlen</span>(cp), <span class="built_in">std</span>::back_inserter(data));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// create a Str from the range denoted by iterators b and e</span></span><br><span class="line">    <span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">In</span>&gt; <span class="title">Str</span>(<span class="title">In</span> <span class="title">b</span>, <span class="title">In</span> <span class="title">e</span>)&#123;</span></span><br><span class="line">        <span class="built_in">std</span>::copy(b, e, <span class="built_in">std</span>::back_inserter(data));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Vec&lt;<span class="keyword">char</span>&gt; data;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>It can be observed that our <strong>Str</strong> is implemented through a hidden <strong>Vec<char></char></strong>. There are four constructors defined in above class. The first functon is a default constructor that creates an empty <strong>Str</strong> through invoking the <strong>Vec</strong> <strong>default constructor</strong>. It is worth noting that we have to explicitly define a default constructor thought it does exactly . If we don’t define a default constructor,the compiler won’t synthesize one for us as there exist other constructors. The second constructor takes a size and a character and initializes the only data member <strong>data</strong> by invoking another <strong>Vec</strong> constructor that takes a size and a value. The third constructor allows us to create a string with passing an argument that is a pointer to char, that is, a null-terminated array of char. It uses the standard algorithm <strong>copy</strong> to copy the elements from the array of char, covering the range <strong>[cp, cp+std::strlen(cp))</strong> into <strong>data</strong>. <strong>cp</strong> points to the first character of the array and <strong>cp + std::strlen(cp)</strong>, where <strong>strlen(cp) returns the length of the array excluding the ‘\0’</strong>, points to one past the last character in the array. Similarly, the last constructor creates a <strong>string</strong> by taking two input iterators that denotes a sequence of characters. But it is worth nothing that it is not a function but a function template. It accepts different kinds of iterators, which implies that it can construct a string object from various containers like the array of char, standard vector, standard list etc.. </p>
<p>We also observed that the <strong>Str</strong> doesn’t define a copy constructor, assignment operator and default destructor. The synthesized operations call the corresponding members of <strong>Vec</strong> when we copy or assign or destruct the <strong>Str</strong> object. In fact, the <strong>Str</strong> class does no memory allocation and hence doesn’t require a destructor. According to the rule of three, a class that needs no destructor doesn’t need an explicit copy constructor or assignment operator either. </p>
<h1 id="Automatic-conversions"><a href="#Automatic-conversions" class="headerlink" title="Automatic conversions"></a>Automatic conversions</h1><p>In the case of the <strong>Str</strong> class, the conversions may happen when we assign a string literal to a string type object. For example:<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Str t;    <span class="comment">// default initialize t</span></span><br><span class="line">t = <span class="string">"hello"</span>;    <span class="comment">// assign a new value to t</span></span><br></pre></td></tr></table></figure></p>
<p>The first statement creates an empty string and the second statement assigns the value of the right-hand side to the left-hand side. However, the left-hand side has type <strong>Str</strong> while the right-hand side has type <strong>const char*</strong>. In addition, we didn’t define the assignment operator. How does the compiler evaluates this expression? It turns out that the compiler will call the constructor that takes the a <strong>const char*</strong>. In other words, the statement invokes the same constructor as the following statement:<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Str <span class="title">t</span><span class="params">(<span class="string">"hello"</span>)</span></span>;</span><br></pre></td></tr></table></figure></p>
<p>This example indicates that constructors also acts a <strong>user-defined conversion</strong> which determines how to transform to and from objects of class type. In generally, we define conversions by defining a constructor with a single argument. The above statement <strong>t = “hello”;</strong> involves two steps: firstly, calling the <strong>Str(const char*)</strong> to construct an unnamed local temporary of type <strong>Str</strong> from the string literal; then calls the synthesized assignment operator to assign this temporary to <strong>t</strong>. </p>
<h1 id="Str-operations"><a href="#Str-operations" class="headerlink" title="Str operations"></a>Str operations</h1><p>Now we further extent the operations of our <strong>Str</strong> class such that a <strong>Str</strong> type string <strong>s</strong> supports following operations:<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cin</span> &gt;&gt; s;    <span class="comment">// use the input operator to read a string</span></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; s;   <span class="comment">// use the output operator to write a string</span></span><br><span class="line">s[i];        <span class="comment">// use the index operator to access a character</span></span><br><span class="line">s1 + s2;     <span class="comment">// use the addition operator to concatenate two strings</span></span><br></pre></td></tr></table></figure></p>
<h2 id="indexing-operator"><a href="#indexing-operator" class="headerlink" title="indexing operator"></a>indexing operator</h2><p>We have learned how to define a operator, such as <strong>operator=</strong>, in defining the <strong>Vec</strong> class. We can define these operators in a similar manner. All above operators are binary operators and hence each operator function takes two parameters, one of which may be implicit if the function is a member. We are familar with the indexing operator. Let’s define it first:<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Str</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// constructors as before</span></span><br><span class="line">    <span class="keyword">char</span>&amp; <span class="keyword">operator</span>[](size_type i) &#123; <span class="keyword">return</span> data[i]; &#125;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">char</span>&amp; <span class="keyword">operator</span>[](size_type i) <span class="keyword">const</span> &#123; <span class="keyword">return</span> data[i]; &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Vec&lt;<span class="keyword">char</span>&gt; data;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>We define two operators to take the case that access elements of a const string into consideration. Details of the implementation go to the indexing operator defined in the <strong>Vec<char></char></strong>. </p>
<h2 id="input-and-output-operator"><a href="#input-and-output-operator" class="headerlink" title="input and output operator"></a>input and output operator</h2><p>Now let’s think about how to implement the input operator <strong>&gt;&gt;</strong> and the output operator <strong>&lt;&lt;</strong>. The first problem is should these operators be members of a class? Due to the operator (e.g. &gt;&gt;) changes the state of a string, we might think it should be a member of the <strong>Str</strong>. But it is also known that the left operand is bound to the first parameter while the right operand is bound to the second parameter. Thus,<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cin</span> &gt;&gt; s;</span><br></pre></td></tr></table></figure></p>
<p>is equivalent to<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cin.operator &gt;&gt; (s);</span><br></pre></td></tr></table></figure></p>
<p>which calls the overloaded &gt;&gt; operator defined for the object <strong>cin</strong>. This implies that the operator should be a member of the <strong>istream</strong> class. However, we cannot define such operation as we don’t have the definition of the <strong>istream</strong> class. If we define the operator in <strong>Str</strong>, it should invoke the input operation through<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s.operation&gt;&gt; (<span class="built_in">cin</span>);</span><br></pre></td></tr></table></figure></p>
<p>or equivalently,<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s &gt;&gt; cin;</span><br></pre></td></tr></table></figure></p>
<p>which obviously would flout the conventions used throughout the library. </p>
<p>Know then that both the input and output operators should be non-member functions. Let’s declare two non-member functions:<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">std</span>::istream&amp; <span class="keyword">operator</span>&gt;&gt;(<span class="built_in">std</span>::istream&amp;, Str&amp;);</span><br><span class="line"><span class="built_in">std</span>::ostream&amp; <span class="keyword">operator</span>&lt;&lt;(<span class="built_in">std</span>::ostream&amp;, <span class="keyword">const</span> Str&amp;);</span><br></pre></td></tr></table></figure></p>
<p>To write the output operator, we need to access each character stored in the <strong>Str</strong>. Therefore, the implementation could be<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ostream&amp; <span class="keyword">operator</span>&lt;&lt;(ostream&amp; os, <span class="keyword">const</span> Str&amp; s)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span>(Str::size_type i = <span class="number">0</span>; i != s.size(); ++i)</span><br><span class="line">        os &lt;&lt; s[i];</span><br><span class="line">    <span class="keyword">return</span> os;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>To use this function, we have to define the <strong>size</strong> member first<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Str</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">size_type <span class="title">size</span><span class="params">()</span> <span class="keyword">const</span> </span>&#123; <span class="keyword">return</span> data.size(); &#125;</span><br><span class="line">    <span class="comment">// as before</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<h3 id="Friends"><a href="#Friends" class="headerlink" title="Friends"></a>Friends</h3><p>Unlike the output operator, the input operator is a little bit complex. The logic is that each time read one character from the input stream and then add the character to our <strong>Str</strong>. The experience of using the standard <strong>string</strong> tells us that when reading data from the input stream, it discards the leading whitespace. Beyond this, we should also take into consider the case that there exist old values in the <strong>Str</strong>. Let’s see how following code deal with these problems.<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// this code won't compile quite yet</span></span><br><span class="line">istream&amp; <span class="keyword">operator</span>&gt;&gt;(istream&amp; is, Str&amp; s)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// obliterate existing value(s)</span></span><br><span class="line">    s.data.clear();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// read and discard leading whitespace</span></span><br><span class="line">    <span class="keyword">char</span> c;</span><br><span class="line">    <span class="keyword">while</span>(is.get(c) &amp;&amp; <span class="built_in">isspace</span>(c))</span><br><span class="line">        ; <span class="comment">// nothing to do except testing the condition</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// if still something to read, do so until next whitespace character</span></span><br><span class="line">    <span class="keyword">if</span>(is) &#123;</span><br><span class="line">        <span class="keyword">do</span> s.data.push_back(c); </span><br><span class="line">        <span class="keyword">while</span>(is.get(c) &amp;&amp; !<span class="built_in">isspace</span>(c));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// if we read whitespace, then put it back on the stream</span></span><br><span class="line">        <span class="keyword">if</span>(is)</span><br><span class="line">            is.unget();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> is;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<ol>
<li>the first step is to obliterate the old values. </li>
<li>the second step is to discard the leading whitespace. Two conditions control the while loop, one is that whether characters are available and another one is that whether the character read from the input stream is a space. The member function <strong>get</strong> extracts one character each time, if there exists characters, it returns the character and will be evaluated to <strong>true</strong>. If there no available character, it returns eof and will be evaluated to <strong>false</strong>. In summary, if the while loop ceases, there would be two situations, no character is available or the character is not a whitespace anymore. </li>
<li>then we perform reading process if there still available character in the input stream after step 2. The reading process calls the member function <strong>push_back</strong> to append one character one time. It stops if it reads nothing from the stream or encounters a whitespace. In the case that it encounters a whitespace, there might be other characters following the extracted whitespace. Therefore, we should put the extracted whitespace back on the stream. This is done by calling another member function of the <strong>istream</strong> class, that is, <strong>unget</strong> which decreases the current location by one character such that the extracted character can be extracted again next. </li>
</ol>
<p>The logic is perfect and we do solve the problems mentioned earlier. However, above code fails to compile due to that <strong>operator&gt;&gt;</strong> is not allowed to access the private data member <strong>data</strong> defined in the <strong>Str</strong>. We could add public member functions <strong>clear</strong> and <strong>push_back</strong> to our <strong>Str</strong> class like we did for our <strong>Vec</strong> class. But in this case, well solve this problem with an alternative method, using keyword <strong>friend</strong>.<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Str</span>&#123;</span></span><br><span class="line">    <span class="keyword">friend</span> <span class="built_in">std</span>::istream&amp; <span class="keyword">operator</span>&gt;&gt;(<span class="built_in">std</span>::istream&amp;, Str&amp;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>A <strong>friend</strong> gives the function <strong>operator&gt;&gt;</strong> access and write rights to the private data members defined in the <strong>Str</strong> class. In other words, if making one function a <strong>friend</strong> of a class, we are saying that the function will be treated as a member (either public or private) by the class. Above code shows that we add the declaration of <strong>operator&gt;&gt;</strong> into the <strong>Str</strong> class and specify it is a friend of the class. </p>
<h2 id="Other-binary-operators"><a href="#Other-binary-operators" class="headerlink" title="Other binary operators"></a>Other binary operators</h2><p>We also consider that define the addition operator as a non-member function. The reason is that the addition operation doesn’t change values of the left-hand operand as well as the right-hand operand. The result of the addition operation between two strings is a string that concatenates two strings. Thus, the return type shoule be <strong>Str</strong>. Therefore, the <strong>operator=</strong> may be declared as follows:<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Str <span class="keyword">operator</span>+(<span class="keyword">const</span> Str&amp;, <span class="keyword">const</span> Str&amp;);</span><br></pre></td></tr></table></figure></p>
<p>After we complete writing the implementation, our program would supports the concatenation operation between two <strong>Str</strong>s through<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Str s1 = <span class="string">"xxx"</span>;</span><br><span class="line">Str s2 = <span class="string">"yyy"</span>;</span><br><span class="line">s1 = s1 + s2;</span><br></pre></td></tr></table></figure></p>
<p>Our experience tells us that we can concatenate two standard strings in an alternative form:<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">s1 += s2;</span><br></pre></td></tr></table></figure></p>
<p>Both two statements involve two processes: the right-hand side creates a new temporary object that is the concatenation of two strings, then the value of the constructed object is assigned to the left-hand side. The difference is that <strong>operator+=</strong> changes the value of left-hand operand. Therefore, we will define the <strong>operator+=</strong> as a public member of the <strong>Str</strong> class. Let’s see how to define <strong>operator+=</strong> first<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Str</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    Str&amp; <span class="keyword">operator</span>+=(<span class="keyword">const</span> Str&amp; s)&#123;</span><br><span class="line">        <span class="built_in">std</span>::copy(s.data.begin(), s.data.end(), <span class="built_in">std</span>::back_inserter(data));</span><br><span class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// as before</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Vec&lt;<span class="keyword">char</span>&gt; data;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// as before</span></span><br><span class="line">Str <span class="keyword">operator</span>+(<span class="keyword">const</span> Str&amp;, <span class="keyword">const</span> Str&amp;);</span><br></pre></td></tr></table></figure></p>
<p>There is nothing new in above implementation of the <strong>operator+=</strong>. Now let’s define the <strong>operator+</strong>:<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Str <span class="keyword">operator</span>+(<span class="keyword">const</span> Str&amp; s, <span class="keyword">const</span> Str&amp; t)&#123;</span><br><span class="line">    Str r = s;</span><br><span class="line">    r += t;</span><br><span class="line">    <span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>In the definition, we use the <strong>operator+=</strong> and the synthesized copy constructor to achieve the concatenation of two strings.  </p>
<h2 id="Mixed-type-expressions"><a href="#Mixed-type-expressions" class="headerlink" title="Mixed-type expressions"></a>Mixed-type expressions</h2><p>The standard library <strong>string</strong> class also allows us to concatenate a string literal and a string regardless there order. As a result, we get a new string type object. For our <strong>Str</strong> class, we have defined the concatenation <strong>operator</strong> that takes operands of type <strong>const Str&amp;</strong>. So, What would happen if following statement is evaluated:<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Str greeting = <span class="string">"Hello, "</span> + name + <span class="string">"!"</span>; <span class="comment">// where **name** is a **Str** type object.</span></span><br></pre></td></tr></table></figure></p>
<p>an alternative and equivalent statement<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Str greeting = (<span class="string">"Hello, "</span> + name) + <span class="string">"!"</span>;</span><br></pre></td></tr></table></figure></p>
<p>We can observe that there are two forms of <strong>+</strong>. The first <strong>+</strong> takes a string literal as its first operand and a <strong>Str</strong> as its seconnd operand, while in the other, the left operand is a <strong>Str</strong> and the right operand is a string literal. We may think that we should define two additional <strong>operator+</strong> to handle these two case as the <strong>operator+</strong> defined above only takes two arguments that are both <strong>const Str&amp;</strong>. In fact, our <strong>Str</strong> class handles these expressions already, by means of calling the constructor that takes a <strong>const char*</strong>. This is because that the constructor is also a conversion operator that can convert a <strong>const char*</strong> to a <strong>Str</strong>. Let’s see how exactly the <strong>Str</strong> deal with this statement:<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> <span class="function">Str <span class="title">temp1</span><span class="params">(<span class="string">"Hello, "</span>)</span></span>;        <span class="comment">// call Str::Str(const char*)</span></span><br><span class="line"><span class="number">2.</span> Str temp2 = temp1 + name;    <span class="comment">// call operator+(const Str&amp;, const Str&amp;)</span></span><br><span class="line"><span class="number">3.</span> <span class="function">Str <span class="title">temp3</span><span class="params">(<span class="string">"!"</span>)</span></span>;              <span class="comment">// call Str::Str(const char*)</span></span><br><span class="line"><span class="number">4.</span> Str greeting = temp2 + temp3;<span class="comment">// call operator+(const Str&amp;, const Str&amp;)</span></span><br></pre></td></tr></table></figure></p>
<p>The implied conversion operations may be expensive due to multiple temporaries. But certainly, we still can explicitly define two additional versions o the <strong>operator+</strong> to deal with this case. </p>
<h2 id="Designing-binary-operators"><a href="#Designing-binary-operators" class="headerlink" title="Designing binary operators"></a>Designing binary operators</h2><p>There are some rules in defining binary operators(Koening and Moo 2000):</p>
<p><em>1. If a class supports type conversions, then it is usually good practice to define binary operators as nonmember functions. By doing so, we preserve symmetry between the operands.</em></p>
<p><em>2. If an operator is a member of a class, then that operator’s left operand cannot be the result of an automatic conversion.</em></p>
<p><em>3. The left operand of a nonmember operator, and the right operand of any operator, follow the same rules as any ordinary function argument: the operand can be any type that can be converted to the parameter type.</em></p>
<p><em>4. like the assignment operator itself, all the compound-assignment operators (e.g. +=) should be members of the class.</em></p>
<h2 id="Some-conversions-are-hazardous"><a href="#Some-conversions-are-hazardous" class="headerlink" title="Some conversions are hazardous"></a>Some conversions are hazardous</h2><p>Recalling the <strong>Vec</strong> class designed in last chapter, it contains a constructor that takes a size (and a value if supplied) (as shown below).<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">explicit Vec(size_type n, const T&amp; t = T()) &#123; create(n, t); &#125;</span><br></pre></td></tr></table></figure></p>
<p>The <strong>explicit</strong> specifies that the constructor can only construct an object explicitly. If we don’t declare the <strong>Vec</strong> constructor as <strong>explicit</strong>, then we could implicitly create a Vec of a given size. To illustrate how useful the <strong>explicit</strong> is, let’s see an example:<br>. It is crucial that consider about the type conversion when defining a single parameter constructor for a class.</p>
<h1 id="Conversion-operators"><a href="#Conversion-operators" class="headerlink" title="Conversion operators"></a>Conversion operators</h1><p>We have known that we can implicitly define conversion operations through defining constructors. Those cases typically involve that a class defines how to convert an object from a different type to the type of the class itself. In fact, class authors can also explicitly define <strong>conversion operators</strong>, which determines how to convert an object from its type to a target type.  </p>
<p>A <strong>conversion operator</strong> must be defined as a member of a class, begining with the keyword <strong>operator</strong> followed by the target type name. For example,<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">class <span class="title">Student_info</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">operator</span> <span class="title">double</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">// ... </span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>The <strong>conversion operator</strong> above defines that a <strong>Student_info</strong> can be converted to a <strong>double</strong> type object. The definition of <strong>operator</strong> would say how exactly create a <strong>double</strong> from a <strong>Student_info</strong>. For example, we can convert the class object to its corresponding final grade, and then use this property in calculating an average grade for a class.<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">vector</span>&lt;Student_info&gt; vs;</span><br><span class="line"><span class="comment">// fill up vs</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">double</span> d = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> = <span class="number">0</span>; i != vs.size(); ++i)</span><br><span class="line">    d += vs[i]; <span class="comment">// vs[i] is automatically converted to double</span></span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; <span class="string">"Average grade: "</span> &lt;&lt; d/vs.size() &lt;&lt; <span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure></p>
<p>In fact, we use this kind conversion operator everytime when we write a loop that implicitly tests the value of an <strong>istream</strong>. See the example<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="built_in">cin</span> &gt;&gt; x) &#123; <span class="comment">/*...*/</span> &#125;</span><br></pre></td></tr></table></figure></p>
<p>is equivalent to<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cin</span> &gt;&gt; x;</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">cin</span>) &#123; <span class="comment">/*...*/</span> &#125;</span><br></pre></td></tr></table></figure></p>
<p>It is known that the condition should be an expression that yields a value that is convertible to type <strong>bool</strong>. Using a value of any arithmetic or pointer type automatically converts the value to type <strong>bool</strong>, thus we can uses values of these type in the expression. But a <strong>iostream</strong> object neither an arithmetic type object nor a pointer type object. To makes the <strong>if condition</strong> works in above case, the standard library defines a conversion from type <strong>istream</strong> to <strong>void*</strong>, i.e. a pointer to <strong>void</strong>.<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">istream::<span class="keyword">operator</span> <span class="keyword">void</span>* &#123;</span><br><span class="line">    <span class="comment">/*...*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>The <strong>operator</strong> tests various status flags to to determine whether the <strong>istream</strong> is valid and return either 0 or an implementation-defined non-zero <strong>void*</strong> value to indicate the state of the stream. </p>
<p>It is necessary to explain the use of <strong>void*</strong>. A pointer to <strong>void</strong> is known as a <strong>universal pointer</strong> which can point to any type of object. We cannot deference such pointer because the type of the object to yield is unknown. But we can convert a <strong>void*</strong> to <strong>bool</strong>. </p>
<p>One might wonder why don’t the <strong>istream</strong> define conversion operator to <strong>bool</strong> directly. The reason is that doing so allows the compiler to detect the following erroneous usage:<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> x;</span><br><span class="line"><span class="built_in">cin</span> &lt;&lt; x; <span class="comment">// we should have to written cin &gt;&gt; x</span></span><br></pre></td></tr></table></figure></p>
<p>If the conversion operator converts a <strong>istream</strong> object to <strong>bool</strong>, this expression would convert <strong>cin</strong> to a <strong>bool</strong>, and thereby converts the bool to <strong>int</strong> again. As a result, the converted value is shifted left by a number of bits equal to the value of <strong>x</strong>. </p>
<h1 id="Conversions-and-memory-management"><a href="#Conversions-and-memory-management" class="headerlink" title="Conversions and memory management"></a>Conversions and memory management</h1><p>In this section, we think about the conversion that from a string type to a null-terminated arrays of characters. If we can successfully convert a string to an array of characters, we then can pass the string to a functions that requires and operates on null-terminated arrays.<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Str</span>&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// plausible, but problematic conversion operations</span></span><br><span class="line">    <span class="keyword">operator</span> <span class="keyword">char</span>*();</span><br><span class="line">    <span class="keyword">operator</span> <span class="keyword">const</span> <span class="keyword">char</span>*() <span class="keyword">const</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// as before</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    Vec&lt;<span class="keyword">char</span>&gt; data;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>If above code works, we then can write code such as<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Str S;</span><br><span class="line"><span class="comment">//...</span></span><br><span class="line"><span class="function">ifstream <span class="title">in</span><span class="params">(s)</span></span>; <span class="comment">// wishful thinking: converts s and then open the stream named s</span></span><br></pre></td></tr></table></figure></p>
<p><em>(Noting that since c++11, <strong>ifstream</strong> allows us to open a file using either a string type name or a c-stype(i.e. null-termintated array) name.)</em></p>
<p>There are several difficulties in defining such operator: </p>
<ol>
<li>we can’t simply return <strong>data</strong> as <strong>data</strong> is a <strong>Vec<char></char></strong> while we need an array of <strong>char</strong>.</li>
<li>if we design our <strong>Vec</strong> based on an array of <strong>char</strong>, we could return it as the converted result. However, doing so exposes the private data member, which violates the class <strong>Str</strong>‘s encapsulation. If users obtained a pointer to <strong>data</strong>, they could change the value of the string. In addition, if the string is destroyed, then the pointer becomes invalid and any related operations would be dengerous. </li>
</ol>
<p>To solve the encapsulation problem, we may provide only one conversion to <strong>const char*</strong>. To solve the dangling pointer problem, we may allocate a new space for a copy of the characters from data, and returning a pointer to this newly allocated space. By doing so, users can manage the allocated storage properly. However, this design probably doesn’t work either because the conversion happens implicitly and hence no pointer is provided explicitly. </p>
<p>The standard <strong>string</strong> class takes a different approach that allows us to get a copy of the <strong>string</strong> in a character array but also makes them do explicitly. It defines three member functions to get a character array from a <strong>string</strong>. The first is <strong>c_str()</strong> which copies the contents of the <strong>string</strong> into a null-terminated <strong>char</strong> array. The <strong>string</strong> owns the array and users are expected not to delete the pointer. The data in the array are ephemeral and is only valid until the next call of a member function that might change the <strong>string</strong>. The second <strong>data()</strong> is like <strong>c_str</strong> except that it returns an array that is not null-terminated (c++11 releases this condition and hence data() and c_str() are synonym and return the same value). Finally, the <strong>copy</strong> function takes a <strong>char*</strong> and an integer as arguments, and copies as many characters as indicated by the integer into space pointed by the <strong>char*</strong>, which soace the user must allocate and free. These functions work as we expected. However, this type of <strong>coversions</strong> seems explicitly rather than implicitly. </p>
<hr>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/C/" rel="tag"># C++</a>
          
            <a href="/tags/Notes/" rel="tag"># Notes</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/15/04/2018/Implementing-the-C-STL-Algorithms-Part-1-Simple-Find-Algorithms/" rel="next" title="Implementing the C++ STL Algorithms-Part 1: Simple Find Algorithms">
                <i class="fa fa-chevron-left"></i> Implementing the C++ STL Algorithms-Part 1: Simple Find Algorithms
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/24/04/2018/Elementary-Data-Structures-Stack-C-Implementation/" rel="prev" title="Elementary Data Structures C++ Implementation: dynamic array-based stack">
                Elementary Data Structures C++ Implementation: dynamic array-based stack <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Liam</p>
              <p class="site-description motion-element" itemprop="description">Stochastic Modelling Notes; Programming Notes</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">50</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">2</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/quantliam" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:yanshijiutu@gmail.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#A-simple-string-class"><span class="nav-number">1.</span> <span class="nav-text">A simple string class</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Automatic-conversions"><span class="nav-number">2.</span> <span class="nav-text">Automatic conversions</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Str-operations"><span class="nav-number">3.</span> <span class="nav-text">Str operations</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#indexing-operator"><span class="nav-number">3.1.</span> <span class="nav-text">indexing operator</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#input-and-output-operator"><span class="nav-number">3.2.</span> <span class="nav-text">input and output operator</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Friends"><span class="nav-number">3.2.1.</span> <span class="nav-text">Friends</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Other-binary-operators"><span class="nav-number">3.3.</span> <span class="nav-text">Other binary operators</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Mixed-type-expressions"><span class="nav-number">3.4.</span> <span class="nav-text">Mixed-type expressions</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Designing-binary-operators"><span class="nav-number">3.5.</span> <span class="nav-text">Designing binary operators</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Some-conversions-are-hazardous"><span class="nav-number">3.6.</span> <span class="nav-text">Some conversions are hazardous</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Conversion-operators"><span class="nav-number">4.</span> <span class="nav-text">Conversion operators</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Conversions-and-memory-management"><span class="nav-number">5.</span> <span class="nav-text">Conversions and memory management</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Liam</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">116.8k</span>
  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
